{% extends 'base.html' %}

{% block head %}
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <style>
    /* Always set the map height explicitly to define the size of the div
     * element that contains the map. */
    #map {
      height: 100%;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
      height: 85%;
      margin: 0;
      padding: 0;
    }
  </style>

  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
{% endblock %}
  
{% block content %}

  <div id="map"></div>

  <script>

    function initMap() {
      const map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 37.8, lng: -120},
        zoom: 5
      });

      const icon = {
        url: 'https://svgsilh.com/svg_v2/1093167.svg',
        scaledSize: new google.maps.Size(15, 15)
      };

      const infowindow = new google.maps.InfoWindow({
        content: 'Test Window';
      });

      $.get('/mapping-facilities.json', (data) => {
        for (const f_id in data) {
          
          const marker = new google.maps.Marker({ 
            icon: icon,
            map: map,
            position: {
              lat: parseFloat(data[f_id]['lat']),
              lng: parseFloat(data[f_id]['lng'])
            },
            title: data[f_id]['title'], 
          });
          
          marker.addListener('click', () => {
            infowindow.open(map, marker)
          });
        }
      });
    };


  </script>

  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw0meNSqLUJr9iQ0JLsC0b0xXxwBLrP_U&callback=initMap">
  </script>
  
{% endblock %}